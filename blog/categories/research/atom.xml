<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">

  <title><![CDATA[Category: research | Dong's Blog]]></title>
  <link href="http://guod08.github.io/me//blog/categories/research/atom.xml" rel="self"/>
  <link href="http://guod08.github.io/me//"/>
  <updated>2013-12-14T21:19:15+08:00</updated>
  <id>http://guod08.github.io/me//</id>
  <author>
    <name><![CDATA[Dong Guo]]></name>
    
  </author>
  <generator uri="http://octopress.org/">Octopress</generator>

  
  <entry>
    <title type="html"><![CDATA[Bayesian CTR prediction for Bing]]></title>
    <link href="http://guod08.github.io/me//blog/2013/12/01/bayesian-ctr-prediction-for-bing/"/>
    <updated>2013-12-01T22:07:00+08:00</updated>
    <id>http://guod08.github.io/me//blog/2013/12/01/bayesian-ctr-prediction-for-bing</id>
    <content type="html"><![CDATA[<p>Microsoft published a paper in ICML 2009 named &lsquo;Web-Scale Bayesian Click-Through Rate Prediction for Sponsored Search Advertising in Microsoft&rsquo;s Bing Search Engine&rsquo;,
which is claimed won the competition of most accurate and scalable CTR predictor across MS.
This article shows how to inference this model(let&rsquo;s call it Ad predictor) step-by-step.</p>

<h2>Pros. and Cons.</h2>


<p>I like it because it&rsquo;s totally based on Bayesian, and Bayesian is beautiful. Online learning is naturally supported, and the precition accuracy is comparable with FTRL and OWLQN.
And both training and prediction is light-weight and fast.
Btw: one shortage of this model is it&rsquo;s not sparse, which may be a big issue when applied on big dataset with huge amount of features.</p>

<h2>Inference using Expectation Propagation step by step</h2>


<p>Firstly, following is the factor graph of ad predictor.
<img class="left" src="/images/personal/research/ep/adPredictor.png" width="1200">
<img class="left" src="/images/personal/research/ep/ep_factor_definition.png" width="1200"></p>

<p><img class="left" src="/images/personal/research/ep/ep_step1.png" width="1200"></p>

<p><img class="left" src="/images/personal/research/ep/ep_step2.png" width="1200"></p>

<p><img class="left" src="/images/personal/research/ep/ep_step3.png" width="1200"></p>

<p><img class="left" src="/images/personal/research/ep/ep_step4.png" width="1200"></p>

<p><img class="left" src="/images/personal/research/ep/ep_step5.png" width="1200"></p>

<p><img class="left" src="/images/personal/research/ep/ep_step6.png" width="1200"></p>

<p><img class="left" src="/images/personal/research/ep/ep_step7_1.png" width="1200"></p>

<p><img class="left" src="/images/personal/research/ep/ep_step7_2.png" width="1200"></p>

<p><img class="left" src="/images/personal/research/ep/ep_step7_3.png" width="1200"></p>

<p><img class="left" src="/images/personal/research/ep/ep_step7_4.png" width="1200"></p>

<p><img class="left" src="/images/personal/research/ep/ep_step8.png" width="1200"></p>

<p><img class="left" src="/images/personal/research/ep/ep_step9.png" width="1200"></p>

<p><img class="left" src="/images/personal/research/ep/ep_step10.png" width="1200"></p>

<p><img class="left" src="/images/personal/research/ep/ep_step11.png" width="1200"></p>

<p><img class="left" src="/images/personal/research/ep/ep_step12.png" width="1200"></p>

<p><img class="left" src="/images/personal/research/ep/ep_step13.png" width="1200"></p>

<p>For each sample, we can use the formula of step 13 to update the posterior parameter of W, which is very easy to be implemented.</p>

<h2>Prediction</h2>


<p>After training, we can predict with following formula:
<img class="left" src="/images/personal/research/ep/ep_predict.png" width="1200"></p>

<h2>Prediction Accuracy</h2>


<p>I compared it with FTRL and OWLQN on one dataset for age&amp;gender prediction. AUC of this model is comparable with OWLQN and FTRL, so I recommend you have a try in your case.</p>

<h2>Insights</h2>


<p>1). You can find variance of each feature increases after every exposure, which makes sense.</p>

<p>2). This model shows samples with more features will have bigger variance, which does not make sense very much.
I think the reason is we assume all the features are independent. Any insights from you?</p>
]]></content>
  </entry>
  
</feed>
